<!DOCTYPE html>
<html>
<head>
    <title>Sensors - Proyect Sobek</title>
    {% include 'includeScripts.html' %}
</head>
<body>

{% include 'nav.html' %}

<div class="row">
    <div class="medium-12 columns">
        <h1>Sensors</h1>
    </div>
</div>

<div class="row">
    <div class="medium-6 card">
        <p>
            Select the Sensor you wish to graph:
        </p>
        <label>Field</label>
        <select id="field" onchange="getAreas('area', 'field');"></select>
        <label>Area</label>
        <select id="area" onchange="getSensors('sensor', 'area');"></select>
        <label>Sensor</label>
        <select id="sensor"></select>

        <p>Select the range of dates you wish to graph:</p>

        <label for="from">From</label>
        {#        <input type="text" id="from" name="from">#}
        <input id="from_datetimepicker" type="text"/>
        <label for="to">to</label>
        {#        <input type="text" id="to" name="to">#}
        <input id="to_datetimepicker" type="text"/>

        <button>24h</button>
        <button>7</button>
        <button>15</button>
        <button>30</button>
        <button onclick="getSensorsLog();">Graph</button>
        <button onclick="hideTag('graphs');">Clean</button>
    </div>

    <div class="medium-6 card">
        <section id="graphs">
            <div id="moisture_chart" height="400" width="1000"></div>
            <div id="temperature_chart" height="400" width="1000"></div>

        </section>
    </div>

</div>

{% include 'footer.html' %}
<script>
    google.load("visualization", "1", {packages: ["corechart"]});
    getFields('field', 'area', 'sensor');
    var init_date;
    var end_date;
    var from = jQuery('#from_datetimepicker').datetimepicker({

        closeOnDateSelect: true,
        onSelectDate: function (current_time, $input) {
            init_date = current_time.dateFormat('Y-m-d H:i:s');
        }

    });
    var to = jQuery('#to_datetimepicker').datetimepicker({
        closeOnDateSelect: true,
        onSelectDate: function (current_time, $input) {
            end_date = current_time.dateFormat('Y-m-d H:i:s');

        }
    });


    function getSensorsLog() {

        console.log(init_date);
        console.log(end_date);

        $.ajax({
            url: "/Sensor_Log/",
            data: {
                sensor_id: '0',
                min_date: init_date,
                max_date: end_date,
                ordering: "-log_timestamp"
            },
            success: function (data) {

                console.log(data);

            },
            error: function (data) {
                console.log(data);
            }
        });


    }

</script>
</body>
</html>